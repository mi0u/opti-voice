<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Three-Signal Communication</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="settings-panel.css">
    <link rel="stylesheet" href="calibration.css">
</head>
<body>
    <!-- Calibration Screen -->
    <div class="calibration-screen" id="calibrationScreen" style="display: none;">
        <div class="calibration-container">
            <h1 id="calibrationTitle">Î’Î±Î¸Î¼Î¿Î½ÏŒÎ¼Î·ÏƒÎ· Eye Tracking</h1>
            <div class="calibration-instructions" id="calibrationInstructions">
                <p id="calibrationText">ÎšÎ±Î»ÏÏ‚ Î®ÏÎ¸Î±Ï„Îµ! Î ÏÎ­Ï€ÎµÎ¹ Î½Î± Î²Î±Î¸Î¼Î¿Î½Î¿Î¼Î®ÏƒÎ¿Ï…Î¼Îµ Ï„Î¿ ÏƒÏÏƒÏ„Î·Î¼Î±.</p>
            </div>
            <div class="calibration-arrow" id="calibrationArrow" style="display: none;">
                <span id="arrowIcon">â†‘</span>
            </div>
            <div class="calibration-status" id="calibrationStatus"></div>
            <button class="calibration-btn" id="calibrationBtn">ÎˆÎ½Î±ÏÎ¾Î· Î’Î±Î¸Î¼Î¿Î½ÏŒÎ¼Î·ÏƒÎ·Ï‚ Î Î‘ÎÎ©</button>
        </div>
    </div>

    <div class="gaze-indicator" id="gazeIndicator">ğŸ¯ Initializing...</div>
    <video class="video-preview" id="videoPreview" autoplay playsinline></video>
    <canvas class="eye-visualization" id="eyeVisualization" width="400" height="200"></canvas>

    <!-- Settings Panel Toggle Button -->
    <button class="settings-toggle-btn" id="settingsToggleBtn">âš™ï¸ Settings</button>

    <!-- Settings Panel -->
    <div class="settings-panel" id="settingsPanel">
        <h3>Eye Tracking Settings</h3>

        <div class="setting-group">
            <label for="upThreshold">
                Up Threshold: <span id="upValue">0.60</span>
            </label>
            <input type="range" id="upThreshold" min="0.01" max="1.5" step="0.01" value="0.60">
            <small>Look up sensitivity (0.1 = easy, 1.5 = hard)</small>
        </div>

        <div class="setting-group">
            <label for="downThreshold">
                Down Threshold: <span id="downValue">0.60</span>
            </label>
            <input type="range" id="downThreshold" min="0.01" max="1.5" step="0.01" value="0.60">
            <small>Look down sensitivity (0.1 = easy, 1.5 = hard)</small>
        </div>

        <div class="setting-group">
            <label for="leftThreshold">
                Left Threshold: <span id="leftValue">0.60</span>
            </label>
            <input type="range" id="leftThreshold" min="0.01" max="1.5" step="0.01" value="0.60">
            <small>Look left sensitivity (0.1 = easy, 1.5 = hard)</small>
        </div>

        <div class="setting-group">
            <label for="rightThreshold">
                Right Threshold: <span id="rightValue">0.60</span>
            </label>
            <input type="range" id="rightThreshold" min="0.01" max="1.5" step="0.01" value="0.60">
            <small>Look right sensitivity (0.1 = easy, 1.5 = hard)</small>
        </div>

        <div class="setting-group">
            <label for="holdDuration">
                Hold Duration: <span id="holdValue">500</span>ms
            </label>
            <input type="range" id="holdDuration" min="100" max="2000" step="50" value="500">
            <small>How long to hold gaze (100-2000ms)</small>
        </div>

        <div class="setting-group">
            <label for="stabilityFrames">
                Stability Frames: <span id="stabilityValue">5</span>
            </label>
            <input type="range" id="stabilityFrames" min="2" max="10" step="1" value="5">
            <small>How stable direction must be (2-10 frames)</small>
        </div>

        <div class="setting-group">
            <label for="smoothingFactor">
                Smoothing Factor: <span id="smoothingValue">0.80</span>
            </label>
            <input type="range" id="smoothingFactor" min="0.1" max="0.9" step="0.01" value="0.8">
            <small>Reduce jitter (0.1 = responsive, 0.9 = smooth)</small>
        </div>

        <div class="setting-group">
            <label class="toggle-label">
                <input type="checkbox" id="eyeViewToggle" checked>
                <span>Show Eye Visualization</span>
            </label>
        </div>

        <div class="setting-group">
            <label class="toggle-label">
                <input type="checkbox" id="soundToggle" checked>
                <span>Sound on Detection</span>
            </label>
        </div>

        <button class="reset-btn" id="resetBtn">Reset to Defaults</button>
        <button class="reset-btn" id="recalibrateBtn" style="margin-top: 10px; background: #2196F3;">Re-calibrate Thresholds</button>
        <small class="help-text">Press 'O' key to log current eye tracking values to console</small>
    </div>

    <div class="container">
        <div class="instructions">
            <strong>Look Left</strong> Select Left & Continue | <strong>Look Right</strong> Select Right & Continue | <strong>Look Up</strong> Special Menu
        </div>

        <div class="mode-indicator" id="modeIndicator">Letter Selection Mode</div>

        <div class="menu-container">
            <div class="column" id="leftColumn"></div>
            <div class="column" id="rightColumn"></div>
        </div>

        <div class="text-area-container">
            <textarea class="text-area" id="textArea" readonly placeholder="Your text will appear here..."></textarea>
        </div>
    </div>

    <!-- Configuration -->
    <script src="config.js"></script>

    <!-- Data -->
    <script src="database.js"></script>

    <!-- Utilities -->
    <script src="suggestions.js?v=2.9"></script>
    <script src="storage.js?v=2.9"></script>

    <!-- Features -->
    <script src="menus.js?v=2.9"></script>
    <script src="search.js?v=2.9"></script>
    <script src="actions.js?v=2.9"></script>
    <script type="module" src="eyetracking.js?v=2.9"></script>
    <script src="settings.js?v=2.9"></script>

    <!-- Main Application -->
    <script src="main.js?v=2.9"></script>
</body>
</html>
